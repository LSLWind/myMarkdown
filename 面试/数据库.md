### 索引

**数据库索引介绍一下**

索引一种数据结构，目的是加快检索数据库中的数据，如果不建索引要查询某个数据必须访问磁盘，以块为单位将数据加载至内存进行检验，IO时间很长。实现索引有很多种方式，如hash表，B+树等。

MySQL中索引属于存储引擎的概念，不同引擎对索引的实现方式不尽相同，MySql中主要有InnoDB与MyISAM，都使用B+树。hash索引无法使用范围查询，没办法用索引完成排序，对于大量重复键值效率很低，因此B+树应用范围更广，索引最后仍针对sql语句做where的范围检查，对于表中的每个字段建立索引，查找时可根据索引快速查找，降低IO

 一张表可以建立**任意多个索引，**每个索引可以是**任意多个字段**的组合。索引**可能会提高查询速度**（如果查询时使用了索引），但**一定会减慢写入速度**，因为每次写入时都需要更新索引，所以索引只应该加在经常需要搜索的列上，不要加在写多读少的列上。 

**聚簇索引与非聚簇索引**

聚簇索引的叶子节点就是数据节点，存储key值与整行数据，InnoDB中主键索引就是聚簇索引

非聚簇索引即叶子节点是索引节点，记录聚簇索引的key，查找时先查找到key，在根据这个key查找实际数据，即回表。非聚簇索引并不一定会导致回表，如果查询语句中的字段全部命中索引则不必进行回表查询

**覆盖索引**

 覆盖索引指一个查询语句的执行只用从索引中就能够取得，不必从数据表中读取。查询优化的一种常用手段，即建立特定字段的联合索引，查询时能全部命中，不必回表

**联合索引/最左前缀匹配原则**

联合索引即对多个字段同时建立一个索引，想要命中索引必须按建立索引时的字段顺序严格使用

最左前缀匹配原则即最左优先，在检索数据时从联合索引的最左边开始匹配，示例：
对列col1、列col2和列col3建一个联合索引

```
KEY test_col1_col2_col3 on test(col1,col2,col3);
```

联合索引 test_col1_col2_col3 实际建立了(col1)、(col1,col2)、(col,col2,col3)三个索引。

```
SELECT * FROM test WHERE col1=“1” AND clo2=“2” AND clo4=“4”
```

上面这个查询语句执行时会依照最左前缀匹配原则，检索时会使用索引(col1,col2)进行数据匹配。

**hash索引与b+树索引的区别**

hash索引不能用于范围查询，不能排序，不能使用组合索引，始终使用索引列的全部内容来计算哈希值，但检索效率比b+树效率高

### 存储引擎

**MyISAM和Innodb区别在哪**

MyISAM只支持表级锁、不支持事务和全文索引，

InnoDB支持行级锁、事务安全（ACID兼容）、支持外键。

**Innodb与MyISAM的使用场景**

MyISAM适合插入不频繁而查询频繁，有大量count()计算的场景

InnoDB适合可靠性要求比较高，要求事务，查询、插入、更新都频繁的场景