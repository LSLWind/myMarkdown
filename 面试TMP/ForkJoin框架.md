## Fork/Join框架

ForkJoinPool是ExecutorService接口的实现（其本质还是一个线程池），专为可以递归分解成小块的工作而设计，基本的逻辑为

```
if(当前工作部分足够小){
	直接做
}else{
	把当前工作分成两部分
	调用这两个部分并等待结果
}
```

将上述代码包装在ForkJoinTask子类中，如RecursiveTask。fork就是拆分，Join就是汇总

线程池维护多个Worker线程，每个线程维护一个任务队列（双向队列），在该任务队列中将一个大任务分为多个小任务去执行，如果没任务回去执行其他Worker的小任务（工作窃取），在join时会等待所有任务完成。

### RecursiveTask

抽象类，相当于一个要执行的任务，重写compute()方法，将具体的任务分成两个部分，对每个部分递归调用（直到判断不可再分为止），调用fork方法（fork即将子任务提交给线程池）去执行，之后对每个拆分的任务调用join返回任务的执行结果，汇总即可。

将大任务交给ForkJoinPool去执行，调用compute()拆分任务，汇总结果

### ForkJoinPool

一个线程池，用于执行任务

### 工作窃取

每个线程都有自己的队列，队列只执行一个task，task可以在队列中拆分成多个小task，如果线程发现队列中没有任务，那么该线程可以去执行其他队列中的小task，成为工作窃取

